<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ß–µ–∫-–ª–∏—Å—Ç –∑–∞–∫—É–ø–∫–∏ –•–¶ - –ë–∞—Ä–∞–Ω—á–∏–∫</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        /* –ú–æ–±—ñ–ª—å–Ω–∞ –∞–¥–∞–ø—Ç–∞—Ü—ñ—è */
        @media (max-width: 768px) {
            body {
                padding: 0.5rem;
            }
            
            .mobile-scroll {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }
            
            table {
                min-width: 100%;
                font-size: 0.75rem;
            }
            
            th, td {
                padding: 0.5rem !important;
                min-width: 70px;
            }
            
            th:first-child, td:first-child {
                position: sticky;
                left: 0;
                background: white;
                z-index: 10;
                min-width: 120px;
                max-width: 150px;
            }
            
            thead th:first-child {
                background: rgb(248 250 252);
                z-index: 11;
            }
            
            input[type="number"] {
                font-size: 0.875rem;
                padding: 0.375rem !important;
                min-width: 60px;
            }
            
            .header-buttons {
                flex-direction: column;
                width: 100%;
            }
            
            .header-buttons button {
                width: 100%;
            }
            
            h1 {
                font-size: 1.5rem !important;
            }
            
            h2 {
                font-size: 1.125rem !important;
            }
        }
        
        /* –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è —á–∏—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—ñ –Ω–∞ –º–∞–ª–∏—Ö –µ–∫—Ä–∞–Ω–∞—Ö */
        @media (max-width: 480px) {
            table {
                font-size: 0.7rem;
            }
            
            th, td {
                padding: 0.375rem !important;
                min-width: 60px;
            }
            
            input[type="number"] {
                font-size: 0.75rem;
                min-width: 50px;
            }
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-50 to-blue-100 p-4">
    <!-- Password Modal -->
    <div id="passwordModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" style="display:none;">
        <div class="bg-white rounded-xl shadow-2xl p-6 max-w-md w-full mx-4">
            <h2 class="text-xl font-bold text-slate-800 mb-4">üîí –í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å</h2>
            <p class="text-slate-600 mb-4">–î–ª—è —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –Ω–æ—Ä–º –ø–æ—Ç—Ä—ñ–±–µ–Ω –ø–∞—Ä–æ–ª—å</p>
            <input type="password" id="passwordInput" 
                class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 mb-4" 
                placeholder="–í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å"/>
            <div class="flex gap-2">
                <button onclick="checkPassword()" 
                    class="flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium">
                    –ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏
                </button>
                <button onclick="closePasswordModal()" 
                    class="flex-1 px-4 py-2 bg-slate-300 text-slate-700 rounded-lg hover:bg-slate-400 font-medium">
                    –°–∫–∞—Å—É–≤–∞—Ç–∏
                </button>
            </div>
            <p id="passwordError" class="text-red-600 text-sm mt-2" style="display:none;">‚ùå –ù–µ–≤—ñ—Ä–Ω–∏–π –ø–∞—Ä–æ–ª—å</p>
        </div>
    </div>

    <div class="max-w-7xl mx-auto">
        <!-- Header -->
        <div class="bg-white rounded-xl shadow-lg p-4 md:p-6 mb-4 md:mb-6">
            <div class="flex items-center justify-between mb-4 flex-wrap gap-4">
                <div class="flex items-center gap-3">
                    <span class="text-2xl md:text-3xl">üõí</span>
                    <div>
                        <h1 class="text-2xl md:text-3xl font-bold text-slate-800">–ß–µ–∫-–ª–∏—Å—Ç –∑–∞–∫—É–ø–∫–∏ –•–¶</h1>
                        <p class="text-xs md:text-base text-slate-600">–†–µ—Å—Ç–æ—Ä–∞–Ω "–¢–æ–π –°–∞–º–∏–π –ë–∞—Ä–∞–Ω—á–∏–∫ –ö—Ä–µ–º–µ–Ω—á—É–∫"</p>
                    </div>
                </div>
                <div id="status" style="display:none"></div>
            </div>

            <!-- Info -->
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 md:p-4 mb-4 text-xs md:text-sm">
                <p class="text-blue-800 mb-1"><strong>–û–≤–æ—á—ñ —Ç–∞ –∑–µ–ª–µ–Ω—å:</strong> –∑–∞–∫—É–ø–∫–∞ –≤—Ç-—Å—Ä, –ø—Ç-–Ω–¥</p>
                <p class="text-blue-800 mb-1"><strong>–ú'—è—Å–æ:</strong> —Ä—ñ–∑–Ω–∏–π –≥—Ä–∞—Ñ—ñ–∫ –ø–æ –¥–Ω—è—Ö —Ç–∏–∂–Ω—è</p>
                <p class="text-blue-800 mb-1"><strong>–ú–∞—Ä–∏–Ω–æ–≤–∞–Ω—ñ –æ–≤–æ—á—ñ:</strong> –∑–∞–∫—É–ø–∫–∞ —Å–±-–Ω–¥ –Ω–∞ –≤—Ç</p>
                <p class="text-blue-800 mt-2">üîí <strong>–ó–∞—Ö–∏—Å—Ç:</strong> —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –Ω–æ—Ä–º –∑–∞—Ö–∏—â–µ–Ω–æ –ø–∞—Ä–æ–ª–µ–º</p>
            </div>

            <!-- Export -->
            <div class="flex flex-wrap gap-2 header-buttons">
                <button onclick="exportToExcel()" class="px-3 md:px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 font-medium text-sm">
                    üìä –ï–∫—Å–ø–æ—Ä—Ç Excel
                </button>
                <button onclick="printList()" class="px-3 md:px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium text-sm">
                    üñ®Ô∏è –î—Ä—É–∫
                </button>
                <button onclick="clearAll()" class="px-3 md:px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 font-medium text-sm">
                    üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç–∏ –≤—Å–µ
                </button>
                <button onclick="togglePasswordProtection()" class="px-3 md:px-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 font-medium text-sm">
                    <span id="lockIcon">üîì</span> <span id="lockText">–†–æ–∑–±–ª–æ–∫—É–≤–∞—Ç–∏</span>
                </button>
            </div>
        </div>

        <!-- Content -->
        <div id="checklist-container"></div>

        <!-- Footer -->
        <div class="bg-white rounded-xl shadow-lg p-4 md:p-6 mt-4 md:mt-6">
            <div class="text-xs md:text-sm text-slate-600">
                <p class="mb-2">–î–∞—Ç–∞ —Å–∫–ª–∞–¥–∞–Ω–Ω—è: <span id="date"></span></p>
                <p class="mb-2">–í—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–∞ –æ—Å–æ–±–∞: _________________</p>
                <p>–ü—ñ–¥–ø–∏—Å: _________________</p>
            </div>
        </div>
    </div>

    <script>
        const PASSWORD = "1234"; // –ó–º—ñ–Ω—ñ—Ç—å –ø–∞—Ä–æ–ª—å —Ç—É—Ç
        let isUnlocked = false;
        let pendingField = null;

        const categories = {
            '–û–í–û–ß–Ü –¢–ê –ó–ï–õ–ï–ù–¨': {
                schedule: '–≤—Ç-—Å—Ä, –ø—Ç-–Ω–¥',
                items: ['–û–≥—ñ—Ä–æ–∫ —Å–≤—ñ–∂–∏–π','–ü–æ–º—ñ–¥–æ—Ä —á–µ—Ä—ñ','–ü–µ—Ä–µ—Ü—å —Å–æ–ª–æ–¥–∫–∏–π','–ü–µ—Ä–µ—Ü—å —á—ñ–ª—ñ','–¶–∏–±—É–ª—è –º–∞—Ä—Å','–¶–∏–±—É–ª—è –∑–µ–ª–µ–Ω–∞','–°–∞–ª–∞—Ç –†–æ–º–µ–Ω','–°–∞–ª–∞—Ç –ê–π—Å–±–µ—Ä–≥','–ö—ñ–Ω–∑–∞','–®–ø–∏–Ω–∞—Ç','–ö—Ä—ñ–ø','–ü–µ—Ç—Ä—É—à–∫–∞','–†—É–∫–æ–ª–∞','–ú\'—è—Ç–∞','–¢–∞—Ä—Ö—É–Ω','–ö–∞—Ä—Ç–æ–ø–ª—è','–ö–∞–ø—É—Å—Ç–∞ –±/–∫','–ë–∞–∫–ª–∞–∂–∞–Ω','–°–µ–ª–µ—Ä–∞ —Å—Ç–µ–±–ª–æ','–ß–∞—Å–Ω–∏–∫','–ë—É—Ä—è–∫']
            },
            '–ú\'–Ø–°–û –¢–ê –ü–¢–ò–¶–Ø': {
                items: ['–°—Ç–µ–≥–Ω–æ –∫—É—Ä—è—á–µ (–ø–Ω-–≤—Ç)','–ü–µ—á—ñ–Ω–∫–∞ –∫—É—Ä—è—á–∞ (–ø–Ω,–≤—Ç,—Å—Ä)','–ö–∞—á–∫–∞ —Ñ—ñ–ª–µ (–ø–Ω,–≤—Ç,—Å—Ä,—á—Ç,–ø—Ç,—Å–±)','–¢–µ–ª—è—Ç–∏–Ω–∞ —Ç–æ–≤—Å—Ç–∏–π –∫—Ä–∞–π']
            },
            '–†–ò–ë–ê –¢–ê –ú–û–†–ï–ü–†–û–î–£–ö–¢–ò': {
                items: ['–õ–æ—Å–æ—Å—å','–û—Å–µ–ª–µ–¥–µ—Ü—å']
            },
            '–ú–û–õ–û–ß–ù–Ü –ü–†–û–î–£–ö–¢–ò –¢–ê –°–ò–†–ò': {
                items: ['–°–∏—Ä —ñ–º–µ—Ä–µ—Ç–∏–Ω—Å—å–∫–∏–π','–°–∏—Ä —Å—É–ª—É–≥—É–Ω—ñ (–∑–≤–∏—á–∞–π–Ω–∏–π)','–°–∏—Ä —Å—É–ª—É–≥—É–Ω—ñ (–∫–æ–ø—á–µ–Ω–∏–π)','–°–∏—Ä —Å—É–ª—É–≥—É–Ω—ñ (–º–æ—Ç–∞–Ω–∫–∞)','–í–µ—Ä—à–∫–∏ 18%','–°–∏—Ä –±—Ä–∏–Ω–∑–∞','–°–∏—Ä –ø–∞—Ä–º–µ–∑–∞–Ω','–°–∏—Ä –∑ –ø–ª—ñ—Å–Ω—è–≤–æ—é','–°–∏—Ä –≥–∞—É–¥–∞','–°–∏—Ä –î–æ–±—Ä–æ–¥–∞—Ä','–°–∏—Ä —Ä—ñ–∫–æ—Ç—Ç–∞','–°–º–µ—Ç–∞–Ω–∞ 20%','–ú–∞—Å–ª–æ –≤–µ—Ä—à–∫–æ–≤–µ']
            },
            '–Ø–ô–¶–Ø': {
                items: ['–Ø–π—Ü—è –∫—É—Ä—è—á—ñ']
            },
            '–°–û–£–°–ò –¢–ê –ó–ê–ü–†–ê–í–ö–ò': {
                items: ['–ì—ñ—Ä—á–∏—Ü—è —Å—Ç–æ–ª–æ–≤–∞','–ì—ñ—Ä—á–∏—Ü—è —Ñ—Ä–∞–Ω—Ü—É–∑—å–∫–∞','–°–æ—É—Å –¢–∫–µ–º–∞–ª—ñ','–°–æ—É—Å —Å–æ—î–≤–∏–π']
            },
            '–•–õ–Ü–ë–û–ë–£–õ–û–ß–ù–Ü –í–ò–†–û–ë–ò': {
                items: ['–õ–∞–≤–∞—à (115–≥)','–ë–∞–≥–µ—Ç']
            },
            '–ì–û–†–Ü–•–ò': {
                items: ['–ì–æ—Ä—ñ—Ö –≤–æ–ª–æ—Å—å–∫–∏–π (–≥—Ä–µ—Ü—å–∫–∏–π)','–ì–æ—Ä—ñ—Ö –∫–µ—à\'—é','–§—É–Ω–¥—É–∫ —Å–º–∞–∂–µ–Ω–∏–π','–ù–∞—Å—ñ–Ω–Ω—è –≥–∞—Ä–±—É–∑–∞']
            },
            '–°–£–•–û–§–†–£–ö–¢–ò –¢–ê –§–†–£–ö–¢–ò': {
                items: ['–ö—É—Ä–∞–≥–∞','–Ü–Ω–∂—ñ—Ä –≤\'—è–ª–µ–Ω–∏–π','–§—ñ–Ω—ñ–∫–∏ —Å—É—à–µ–Ω—ñ','–ñ—É—Ä–∞–≤–ª–∏–Ω–∞ –≤\'—è–ª–µ–Ω–∞','–õ–∏–º–æ–Ω','–í–∏–Ω–æ–≥—Ä–∞–¥','–•—É—Ä–º–∞','–ê–π–≤–∞ —Å/–º','–Ø–±–ª—É–∫–æ']
            },
            '–°–ü–ï–¶–Ü–á –¢–ê –ü–†–ò–ü–†–ê–í–ò': {
                items: ['–°—ñ–ª—å','–®–∞—Ñ—Ä–∞–Ω','–°—É–º–∞—Ö','–û—Ü–µ—Ç –≤–∏–Ω–Ω–∏–π','–°–≤–∞–Ω—Å—å–∫–∞ —Å—ñ–ª—å','–£—Ü—Ö–æ-—Å—É–Ω–µ–ª—ñ','–õ–∏–º–æ–Ω–Ω–∞ –∫–∏—Å–ª–æ—Ç–∞']
            },
            '–Ü–ù–®–Ü –Ü–ù–ì–†–ï–î–Ü–Ñ–ù–¢–ò': {
                items: ['–ú–µ–¥ –Ω–µ—Ç—Ç–æ','–û—Ü–µ—Ç –≤–∏–Ω–Ω–∏–π','–û—Ü–µ—Ç —Å—Ç–æ–ª–æ–≤–∏–π','–û–ª—ñ—è —Å–æ–Ω—è—à–Ω–∏–∫–æ–≤–∞','–û–ª—ñ—è –æ–ª–∏–≤–∫–æ–≤–∞','–û–ª—ñ—è –î–æ–º–∞—à–Ω—è (–∑–∞–ø–∞—à–Ω–∞)','–û–ª—ñ—è –∫—É–Ω–∂—É—Ç–Ω–∞']
            },
            '–ö–û–ü–ß–ï–ù–Ü –ü–†–û–î–£–ö–¢–ò': {
                items: ['–°—É–¥–∂—É–∫','–ë–∞—Å—Ç—É—Ä–º–∞','–°–∞–ª–æ —Å–ø–µ–∫','–§—ñ–ª–µ –∫—É—Ä—è—á–µ —Å/–∫']
            },
            '–ú–ê–†–ò–ù–û–í–ê–ù–Ü –û–í–û–ß–Ü': {
                schedule: '—Å–±-–Ω–¥ –Ω–∞ –≤—Ç',
                items: ['–û–≥—ñ—Ä–æ–∫ —Å–æ–ª–æ–Ω–∏–π (–º–∞—Ä–∏–Ω–æ–≤–∞–Ω–∏–π)','–ü–æ–º—ñ–¥–æ—Ä–∏ —Å–æ–ª–æ–Ω—ñ (–º–∞—Ä–∏–Ω–æ–≤–∞–Ω—ñ)','–ß–∞—Å–Ω–∏–∫ —Å–æ–ª–æ–Ω–∏–π (–º–∞—Ä—ñ–Ω–æ–≤–∞–Ω–∏–π)','–ö–∞–ø—É—Å—Ç–∞ –ø–æ-–≥—É—Ä—ñ–π—Å—å–∫–∏ –ø/—Ñ']
            }
        };

        let data = {};

        function initData() {
            Object.keys(categories).forEach(category => {
                data[category] = {};
                categories[category].items.forEach(item => {
                    data[category][item] = { stock: '', weekday: '', weekend: '', orderWeekday: '', orderWeekend: '' };
                });
            });
            loadData();
        }

        function saveData() {
            localStorage.setItem('purchase-checklist-data', JSON.stringify(data));
            showStatus('‚úì –ó–±–µ—Ä–µ–∂–µ–Ω–æ', 'success');
        }

        function loadData() {
            const saved = localStorage.getItem('purchase-checklist-data');
            if (saved) {
                data = JSON.parse(saved);
            }
        }

        function showStatus(msg, type) {
            const statusDiv = document.getElementById('status');
            const colors = { success: 'bg-green-100 text-green-700', error: 'bg-red-100 text-red-700' };
            statusDiv.className = `px-4 py-2 rounded-lg font-medium ${colors[type]}`;
            statusDiv.textContent = msg;
            statusDiv.style.display = 'block';
            setTimeout(() => { statusDiv.style.display = 'none'; }, 2000);
        }

        function handleChange(category, item, field, value) {
            // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞, —á–∏ –ø–æ–ª–µ –∑–∞—Ö–∏—â–µ–Ω–µ –ø–∞—Ä–æ–ª–µ–º
            if ((field === 'weekday' || field === 'weekend') && !isUnlocked) {
                pendingField = { category, item, field, value, element: event.target };
                showPasswordModal();
                return;
            }
            
            data[category][item][field] = value;
            saveData();
            
            // –û–Ω–æ–≤–ª—é—î–º–æ –∫–æ–ª–æ–Ω–∫—É "–î–æ–∑–∞–º–æ–≤–∏—Ç–∏"
            updateOrderAmount(category, item);
        }

        function updateOrderAmount(category, item) {
            const d = data[category][item];
            const stock = parseFloat(d.stock) || 0;
            const weekday = parseFloat(d.weekday) || 0;
            const weekend = parseFloat(d.weekend) || 0;
            
            // –†–æ–∑—Ä–∞—Ö–æ–≤—É—î–º–æ –æ–±–∏–¥–≤—ñ –∫–æ–ª–æ–Ω–∫–∏
            const orderWeekday = Math.max(0, weekday - stock);
            const orderWeekend = Math.max(0, weekend - stock);
            
            // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ —Ä–æ–∑—Ä–∞—Ö–æ–≤–∞–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è
            data[category][item].orderWeekday = orderWeekday;
            data[category][item].orderWeekend = orderWeekend;
            
            // –û–Ω–æ–≤–ª—é—î–º–æ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –¥–ª—è –±—É–¥–Ω—ñ—Ö
            const orderWeekdayCell = document.getElementById(`order-weekday-${category}-${item}`);
            if (orderWeekdayCell) {
                orderWeekdayCell.textContent = orderWeekday > 0 ? orderWeekday.toFixed(1) : '';
            }
            
            // –û–Ω–æ–≤–ª—é—î–º–æ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –¥–ª—è –≤–∏—Ö—ñ–¥–Ω–∏—Ö
            const orderWeekendCell = document.getElementById(`order-weekend-${category}-${item}`);
            if (orderWeekendCell) {
                orderWeekendCell.textContent = orderWeekend > 0 ? orderWeekend.toFixed(1) : '';
            }
            
            // –ü—ñ–¥—Å–≤—ñ—á—É—î–º–æ —Ä—è–¥–æ–∫ —è–∫—â–æ —î —â–æ –∑–∞–º–æ–≤–∏—Ç–∏
            const row = orderWeekdayCell?.closest('tr');
            if (row) {
                if (orderWeekday > 0 || orderWeekend > 0) {
                    row.classList.add('bg-yellow-50');
                } else {
                    row.classList.remove('bg-yellow-50');
                }
            }
        }

        function showPasswordModal() {
            document.getElementById('passwordModal').style.display = 'flex';
            document.getElementById('passwordInput').value = '';
            document.getElementById('passwordError').style.display = 'none';
            document.getElementById('passwordInput').focus();
        }

        function closePasswordModal() {
            document.getElementById('passwordModal').style.display = 'none';
            if (pendingField) {
                // –í—ñ–¥–Ω–æ–≤–ª—é—î–º–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—î –∑–Ω–∞—á–µ–Ω–Ω—è
                pendingField.element.value = data[pendingField.category][pendingField.item][pendingField.field];
                pendingField = null;
            }
        }

        function checkPassword() {
            const input = document.getElementById('passwordInput').value;
            if (input === PASSWORD) {
                isUnlocked = true;
                document.getElementById('passwordModal').style.display = 'none';
                
                // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –≤—ñ–¥–∫–ª–∞–¥–µ–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è
                if (pendingField) {
                    data[pendingField.category][pendingField.item][pendingField.field] = pendingField.value;
                    saveData();
                    updateOrderAmount(pendingField.category, pendingField.item);
                    pendingField = null;
                }
                
                // –û–Ω–æ–≤–ª—é—î–º–æ UI
                updateLockButton();
                renderUI();
                showStatus('‚úì –†–æ–∑–±–ª–æ–∫–æ–≤–∞–Ω–æ', 'success');
            } else {
                document.getElementById('passwordError').style.display = 'block';
            }
        }

        function togglePasswordProtection() {
            if (isUnlocked) {
                // –ë–ª–æ–∫—É—î–º–æ
                isUnlocked = false;
                updateLockButton();
                renderUI();
                showStatus('üîí –ó–∞–±–ª–æ–∫–æ–≤–∞–Ω–æ', 'success');
            } else {
                // –†–æ–∑–±–ª–æ–∫—É—î–º–æ
                showPasswordModal();
            }
        }

        function updateLockButton() {
            document.getElementById('lockIcon').textContent = isUnlocked ? 'üîì' : 'üîí';
            document.getElementById('lockText').textContent = isUnlocked ? '–ó–∞–±–ª–æ–∫—É–≤–∞—Ç–∏' : '–†–æ–∑–±–ª–æ–∫—É–≤–∞—Ç–∏';
        }

        function clearAll() {
            if (confirm('–û—á–∏—Å—Ç–∏—Ç–∏ –≤—Å—ñ –¥–∞–Ω—ñ? –¶–µ –Ω–µ–∑–≤–æ—Ä–æ—Ç–Ω–∞ –¥—ñ—è!')) {
                initData();
                renderUI();
                showStatus('‚úì –î–∞–Ω—ñ –æ—á–∏—â–µ–Ω–æ', 'success');
            }
        }

        function exportToExcel() {
            const wb = XLSX.utils.book_new();
            const dateStr = new Date().toLocaleDateString('uk-UA');
            
            const wsData = [
                ['–†–µ—Å—Ç–æ—Ä–∞–Ω "–¢–æ–π –°–∞–º–∏–π –ë–∞—Ä–∞–Ω—á–∏–∫ –ö—Ä–µ–º–µ–Ω—á—É–∫"'],
                ['–ß–µ–∫-–ª–∏—Å—Ç –∑–∞–∫—É–ø–∫–∏ –¥–ª—è —Ö–æ–ª–æ–¥–Ω–æ–≥–æ —Ü–µ—Ö—É'],
                [`–î–∞—Ç–∞: ${dateStr}`],
                [],
                ['–ö–∞—Ç–µ–≥–æ—Ä—ñ—è', '–ù–∞–π–º–µ–Ω—É–≤–∞–Ω–Ω—è', '–ó–∞–ª–∏—à–æ–∫ —Ñ–∞–∫—Ç–∏—á–Ω–∏–π', '–ù–æ—Ä–º–∞ –±—É–¥–Ω—ñ–π –¥–µ–Ω—å', '–ù–æ—Ä–º–∞ –≤–∏—Ö—ñ–¥–Ω–∏–π –¥–µ–Ω—å', '–î–æ–∑–∞–º–æ–≤–∏—Ç–∏ –±—É–¥–Ω—ñ–π', '–î–æ–∑–∞–º–æ–≤–∏—Ç–∏ –≤–∏—Ö—ñ–¥–Ω–∏–π']
            ];
            
            Object.entries(categories).forEach(([catKey, catData]) => {
                catData.items.forEach(item => {
                    const d = data[catKey][item];
                    const stock = parseFloat(d.stock) || 0;
                    const weekday = parseFloat(d.weekday) || 0;
                    const weekend = parseFloat(d.weekend) || 0;
                    const orderWeekday = Math.max(0, weekday - stock);
                    const orderWeekend = Math.max(0, weekend - stock);
                    
                    wsData.push([
                        catKey, 
                        item, 
                        d.stock || '', 
                        d.weekday || '', 
                        d.weekend || '',
                        orderWeekday > 0 ? orderWeekday.toFixed(1) : '',
                        orderWeekend > 0 ? orderWeekend.toFixed(1) : ''
                    ]);
                });
            });
            
            const ws = XLSX.utils.aoa_to_sheet(wsData);
            ws['!cols'] = [{wch:30},{wch:40},{wch:18},{wch:18},{wch:18},{wch:15},{wch:15}];
            XLSX.utils.book_append_sheet(wb, ws, '–ó–∞–∫—É–ø–∫–∞');
            XLSX.writeFile(wb, `–ó–∞–∫—É–ø–∫–∞_–•–¶_${dateStr}.xlsx`);
            showStatus('‚úì Excel –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ', 'success');
        }

        function printList() {
            const dateStr = new Date().toLocaleDateString('uk-UA');
            
            let printContent = `
                <html>
                <head>
                    <meta charset="UTF-8">
                    <title>–ß–µ–∫-–ª–∏—Å—Ç –∑–∞–∫—É–ø–∫–∏ –•–¶</title>
                    <style>
                        body { font-family: Arial, sans-serif; padding: 20px; }
                        h1 { text-align: center; font-size: 18px; }
                        h2 { text-align: center; font-size: 14px; color: #666; }
                        h3 { font-size: 12px; margin-top: 20px; background: #f0f0f0; padding: 5px; }
                        table { width: 100%; border-collapse: collapse; margin-bottom: 15px; font-size: 10px; }
                        th, td { border: 1px solid #ccc; padding: 4px; text-align: left; }
                        th { background: #f8f8f8; font-weight: bold; }
                        .highlight { background: #fffbcc; }
                        @media print { .no-print { display: none; } }
                    </style>
                </head>
                <body>
                    <h1>–†–µ—Å—Ç–æ—Ä–∞–Ω "–¢–æ–π –°–∞–º–∏–π –ë–∞—Ä–∞–Ω—á–∏–∫ –ö—Ä–µ–º–µ–Ω—á—É–∫"</h1>
                    <h2>–ß–µ–∫-–ª–∏—Å—Ç –∑–∞–∫—É–ø–∫–∏ –¥–ª—è —Ö–æ–ª–æ–¥–Ω–æ–≥–æ —Ü–µ—Ö—É</h2>
                    <p style="text-align: center;"><strong>–î–∞—Ç–∞:</strong> ${dateStr}</p>
            `;
            
            Object.entries(categories).forEach(([catKey, catData]) => {
                const schedule = catData.schedule ? ` (${catData.schedule})` : '';
                printContent += `<h3>${catKey}${schedule}</h3><table><thead><tr>
                    <th>–ù–∞–π–º–µ–Ω—É–≤–∞–Ω–Ω—è</th>
                    <th width="85">–ó–∞–ª–∏—à–æ–∫ —Ñ–∞–∫—Ç–∏—á–Ω–∏–π</th>
                    <th width="85">–ù–æ—Ä–º–∞ –±—É–¥–Ω—ñ–π –¥–µ–Ω—å</th>
                    <th width="85">–ù–æ—Ä–º–∞ –≤–∏—Ö—ñ–¥–Ω–∏–π –¥–µ–Ω—å</th>
                    <th width="85">–î–æ–∑–∞–º–æ–≤–∏—Ç–∏ –±—É–¥–Ω—ñ–π</th>
                    <th width="85">–î–æ–∑–∞–º–æ–≤–∏—Ç–∏ –≤–∏—Ö—ñ–¥–Ω–∏–π</th>
                </tr></thead><tbody>`;
                
                catData.items.forEach(item => {
                    const d = data[catKey][item];
                    const stock = parseFloat(d.stock) || 0;
                    const weekday = parseFloat(d.weekday) || 0;
                    const weekend = parseFloat(d.weekend) || 0;
                    const orderWeekday = Math.max(0, weekday - stock);
                    const orderWeekend = Math.max(0, weekend - stock);
                    const highlightClass = (orderWeekday > 0 || orderWeekend > 0) ? ' class="highlight"' : '';
                    
                    printContent += `<tr${highlightClass}>
                        <td>${item}</td>
                        <td style="text-align: center;">${d.stock || ''}</td>
                        <td style="text-align: center;">${d.weekday || ''}</td>
                        <td style="text-align: center;">${d.weekend || ''}</td>
                        <td style="text-align: center;">${orderWeekday > 0 ? orderWeekday.toFixed(1) : ''}</td>
                        <td style="text-align: center;">${orderWeekend > 0 ? orderWeekend.toFixed(1) : ''}</td>
                    </tr>`;
                });
                printContent += '</tbody></table>';
            });
            
            printContent += `
                <p style="margin-top: 30px; font-size: 11px;">
                    –í—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–∞ –æ—Å–æ–±–∞: _________________ &nbsp;&nbsp;&nbsp; –ü—ñ–¥–ø–∏—Å: _________________
                </p>
                <div class="no-print" style="text-align: center; margin-top: 20px;">
                    <button onclick="window.print()" style="padding: 10px 20px; font-size: 14px; cursor: pointer;">üñ®Ô∏è –î—Ä—É–∫—É–≤–∞—Ç–∏</button>
                    <button onclick="window.close()" style="padding: 10px 20px; font-size: 14px; cursor: pointer; margin-left: 10px;">‚ùå –ó–∞–∫—Ä–∏—Ç–∏</button>
                </div>
            </body></html>`;
            
            const printWindow = window.open('', '_blank');
            printWindow.document.write(printContent);
            printWindow.document.close();
            printWindow.focus();
            showStatus('‚úì –ì–æ—Ç–æ–≤–æ –¥–æ –¥—Ä—É–∫—É', 'success');
        }

        function renderUI() {
            let html = '';
            Object.entries(categories).forEach(([catKey, catData]) => {
                const schedule = catData.schedule ? `<span class="text-xs md:text-sm text-blue-600 font-normal"> (${catData.schedule})</span>` : '';
                html += `<div class="bg-white rounded-xl shadow-lg p-3 md:p-6 mb-4 md:mb-6">
                    <h2 class="text-lg md:text-xl font-bold text-slate-800 mb-3 md:mb-4 pb-2 border-b-2 border-blue-600">
                        ${catKey}${schedule}
                    </h2>
                    <div class="mobile-scroll overflow-x-auto"><table class="w-full">
                    <thead><tr class="bg-slate-50">
                        <th class="text-left p-2 md:p-3 font-semibold text-slate-700 border-b-2 border-slate-200 text-xs md:text-sm">–ù–∞–π–º–µ–Ω—É–≤–∞–Ω–Ω—è</th>
                        <th class="text-center p-2 md:p-3 font-semibold text-slate-700 border-b-2 border-slate-200 w-20 md:w-32 text-xs md:text-sm">–ó–∞–ª–∏—à–æ–∫</th>
                        <th class="text-center p-2 md:p-3 font-semibold text-slate-700 border-b-2 border-slate-200 w-20 md:w-32 text-xs md:text-sm">
                            –ù–æ—Ä–º–∞ –±—É–¥. ${!isUnlocked ? 'üîí' : ''}
                        </th>
                        <th class="text-center p-2 md:p-3 font-semibold text-slate-700 border-b-2 border-slate-200 w-20 md:w-32 text-xs md:text-sm">
                            –ù–æ—Ä–º–∞ –≤–∏—Ö. ${!isUnlocked ? 'üîí' : ''}
                        </th>
                        <th class="text-center p-2 md:p-3 font-semibold text-green-700 border-b-2 border-slate-200 w-20 md:w-32 text-xs md:text-sm">–î–æ–∑–∞–º. –±—É–¥.</th>
                        <th class="text-center p-2 md:p-3 font-semibold text-green-700 border-b-2 border-slate-200 w-20 md:w-32 text-xs md:text-sm">–î–æ–∑–∞–º. –≤–∏—Ö.</th>
                    </tr></thead><tbody>`;
                
                catData.items.forEach(item => {
                    const d = data[catKey][item];
                    const stock = parseFloat(d.stock) || 0;
                    const weekday = parseFloat(d.weekday) || 0;
                    const weekend = parseFloat(d.weekend) || 0;
                    const orderWeekday = Math.max(0, weekday - stock);
                    const orderWeekend = Math.max(0, weekend - stock);
                    const highlightClass = (orderWeekday > 0 || orderWeekend > 0) ? 'bg-yellow-50' : '';
                    
                    html += `<tr class="border-b border-slate-100 hover:bg-slate-50 ${highlightClass}">
                        <td class="p-2 md:p-3 text-slate-700 text-xs md:text-sm">${item}</td>
                        <td class="p-1 md:p-3">
                            <input type="number" step="0.1" value="${d.stock}" 
                                onchange="handleChange('${catKey}','${item}','stock',this.value)" 
                                class="w-full px-2 py-1 md:px-3 md:py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-center text-xs md:text-sm" 
                                placeholder="0"/>
                        </td>
                        <td class="p-1 md:p-3">
                            <input type="number" step="0.1" value="${d.weekday}" 
                                onchange="handleChange('${catKey}','${item}','weekday',this.value)" 
                                class="w-full px-2 py-1 md:px-3 md:py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-center text-xs md:text-sm ${!isUnlocked ? 'bg-slate-100 cursor-not-allowed' : ''}" 
                                placeholder="0"
                                ${!isUnlocked ? 'readonly' : ''}/>
                        </td>
                        <td class="p-1 md:p-3">
                            <input type="number" step="0.1" value="${d.weekend}" 
                                onchange="handleChange('${catKey}','${item}','weekend',this.value)" 
                                class="w-full px-2 py-1 md:px-3 md:py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-center text-xs md:text-sm ${!isUnlocked ? 'bg-slate-100 cursor-not-allowed' : ''}" 
                                placeholder="0"
                                ${!isUnlocked ? 'readonly' : ''}/>
                        </td>
                        <td class="p-2 md:p-3 text-center font-semibold text-green-700 text-xs md:text-sm" id="order-weekday-${catKey}-${item}">
                            ${orderWeekday > 0 ? orderWeekday.toFixed(1) : ''}
                        </td>
                        <td class="p-2 md:p-3 text-center font-semibold text-green-700 text-xs md:text-sm" id="order-weekend-${catKey}-${item}">
                            ${orderWeekend > 0 ? orderWeekend.toFixed(1) : ''}
                        </td>
                    </tr>`;
                });
                html += `</tbody></table></div></div>`;
            });
            document.getElementById('checklist-container').innerHTML = html;
        }

        // –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ Enter –≤ –º–æ–¥–∞–ª—å–Ω–æ–º—É –≤—ñ–∫–Ω—ñ
        document.addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && document.getElementById('passwordModal').style.display === 'flex') {
                checkPassword();
            }
        });

        window.addEventListener('DOMContentLoaded', () => {
            initData();
            renderUI();
            document.getElementById('date').textContent = new Date().toLocaleDateString('uk-UA');
        });
    </script>
</body>
</html>